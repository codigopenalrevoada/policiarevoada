# PROTEÇÕES DE SEGURANÇA - CALCULADORA PENAL

# Desabilitar listagem de diretórios
Options -Indexes

# Proteger contra hotlinking
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?seu-dominio.com [NC]
RewriteRule \.(jpg|jpeg|png|gif|css|js)$ - [F]

# Headers de segurança
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:;"
</IfModule>

# Proteger arquivos sensíveis
<Files "*.js">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "0"
</Files>

# Bloquear acesso direto a arquivos JavaScript
<Files "modelo-artigos.js">
    Order Deny,Allow
    Deny from all
</Files>

<Files "modelo-fianca.js">
    Order Deny,Allow
    Deny from all
</Files>

<Files "protecao.js">
    Order Deny,Allow
    Deny from all
</Files>

# Permitir apenas através do HTML principal
<Files "index.html">
    Order Allow,Deny
    Allow from all
</Files>

# Proteger contra ataques comuns
<IfModule mod_rewrite.c>
    RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
    RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
    RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2}) [OR]
    RewriteCond %{QUERY_STRING} proc/self/environ [OR]
    RewriteCond %{QUERY_STRING} mosConfig [OR]
    RewriteCond %{QUERY_STRING} base64_(en|de)code\(.*\) [OR]
    RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
    RewriteCond %{QUERY_STRING} (\<|%3C).*iframe.*(\>|%3E) [NC]
    RewriteRule .* - [F]
</IfModule> 